{"version":3,"sources":["/Users/jz/shuyun/shuyun-ep-utils/src/download/index.ts","/Users/jz/shuyun/shuyun-ep-utils/src/download/README.mdx"],"names":["downloadWithPromise","ajax","options","filename","_options$type","type","then","res","blob","Blob","url","window","URL","createObjectURL","a","document","createElement","setAttribute","body","appendChild","click","removeChild","layoutProps","MDXLayout","MDXContent","_ref","components","props","Object","objectWithoutProperties","index_es","assign","mdxType","id","parentName","className","index_esm","__position","__code","__scope","this","Playground","Button","__codesandbox","variant","color","onClick","fetch","text","concat","Date","now","isMDXComponent"],"mappings":"ibAGO,SAASA,EAAoBC,EAAoBC,GAA2B,IAE/EC,EAEED,EAFFC,SAF+EC,EAI7EF,EADFG,YAH+E,IAAAD,EAGxE,kBAHwEA,EAMjF,OAAOH,EAAKK,KAAK,SAACC,GAChB,IAAMC,EAAO,IAAIC,KAAK,CAACF,GAAM,CAAEF,SACzBK,EAAMC,OAAOC,IAAIC,gBAAgBL,GACjCM,EAAIC,SAASC,cAAc,KAOjC,OANAF,EAAEG,aAAa,OAAQP,GACvBI,EAAEG,aAAa,WAAYd,GAC3BW,EAAEG,aAAa,QAAS,gBACxBF,SAASG,KAAKC,YAAYL,GAC1BA,EAAEM,QACFL,SAASG,KAAKG,YAAYP,GACnBP,8NCXX,IAKMe,EAAc,GAGdC,EAAY,UACH,SAASC,EAATC,GAGZ,IAFDC,EAECD,EAFDC,WACGC,EACFC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,gBACD,OAAOG,OAAAE,EAAA,EAAAF,CAACL,EAADK,OAAAG,OAAA,GAAeT,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYM,QAAQ,cAC5EJ,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,uBADR,uBAGAL,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,QADR,QAGAL,OAAAE,EAAA,EAAAF,CAAA,SAAGA,OAAAE,EAAA,EAAAF,CAAA,cAAYM,WAAW,KAAvB,uBAAH,iCAA2EN,OAAAE,EAAA,EAAAF,CAAA,cAAYM,WAAW,KAAvB,QAA3E,kFACAN,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,OADR,OAGAL,OAAAE,EAAA,EAAAF,CAAA,sDAAcA,OAAAE,EAAA,EAAAF,CAAA,cAAYM,WAAW,KAAvB,KAAd,yGAAgFN,OAAAE,EAAA,EAAAF,CAAA,cAAYM,WAAW,KAAvB,WAAhF,qBAA0IN,OAAAE,EAAA,EAAAF,CAAA,cAAYM,WAAW,KAAvB,SAA1I,uFAA6MN,OAAAE,EAAA,EAAAF,CAAA,cAAYM,WAAW,KAAvB,OAA7M,4KACAN,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,QADR,QAGAL,OAAAE,EAAA,EAAAF,CAAA,uJACAA,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,OADR,OAGAL,OAAAE,EAAA,EAAAF,CAAA,WAAKA,OAAAE,EAAA,EAAAF,CAAA,OAAAA,OAAAG,OAAA,CAAMG,WAAW,OAAU,CAC5BC,UAAa,iBADZ,4LAQLP,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,QADR,QAIAL,OAAAE,EAAA,EAAAF,CAACQ,EAAA,EAAD,CAAYC,WAAY,EAAGC,OAAQ,4TAA6SC,QAAS,CACvVZ,MAAOa,KAAOA,KAAKb,MAAQA,EAC3Bc,eACAC,WACA1C,uBACC2C,cAAa,82EAAi3EX,QAAQ,cAC34EJ,OAAAE,EAAA,EAAAF,CAACc,EAAA,EAAD,CAAQE,QAAQ,WAAWC,MAAM,UAAUC,QAAS,WAE9C9C,EADqBW,OAAOoC,MAAM,qBAAqBzC,KAAK,SAAAC,GAAG,OAAIA,EAAIyC,SACrC,CAChC7C,SAAQ,YAAA8C,OAAcC,KAAKC,MAAnB,UAETnB,QAAQ,UALf,2MAWFR,EAAW4B,gBAAiB","file":"static/js/src-download-readme.573473dc.js","sourcesContent":["import { IDownloadOptions } from './index.d';\n\n\nexport function downloadWithPromise(ajax: Promise<any>, options: IDownloadOptions) {\n  const {\n    filename,\n    type = 'application/txt'\n  } = options;\n\n  return ajax.then((res) => {\n    const blob = new Blob([res], { type });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.setAttribute('href', url);\n    a.setAttribute('download', filename);\n    a.setAttribute('style', 'display:none');\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    return res;\n  });\n}\n","/* @jsx mdx */\n  import React from 'react'\n  import { mdx } from '@mdx-js/react'\n  /* @jsx mdx */\nimport { Playground } from 'docz';\nimport Button from '@material-ui/core/Button';\nimport { downloadWithPromise } from './index';\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"downloadwithpromise\"\n    }}>{`downloadWithPromise`}</h1>\n    <h2 {...{\n      \"id\": \"what\"\n    }}>{`What`}</h2>\n    <p><inlineCode parentName=\"p\">{`downloadWithPromise`}</inlineCode>{`函数是通过`}<inlineCode parentName=\"p\">{`ajax`}</inlineCode>{`调用接口来下载文件的函数。`}</p>\n    <h2 {...{\n      \"id\": \"why\"\n    }}>{`Why`}</h2>\n    <p>{`以前我们是通过`}<inlineCode parentName=\"p\">{`a`}</inlineCode>{`标签来实现下载，但是这种方式无法在`}<inlineCode parentName=\"p\">{`headers`}</inlineCode>{`中设置`}<inlineCode parentName=\"p\">{`Token`}</inlineCode>{`，因此无法鉴权，而且只能使用`}<inlineCode parentName=\"p\">{`GET`}</inlineCode>{`请求。为了解决这两个问题所以提供该函数用来处理下载问题。`}</p>\n    <h2 {...{\n      \"id\": \"when\"\n    }}>{`When`}</h2>\n    <p>{`在做导出文件时可以使用，具体要看场景，勿滥用。`}</p>\n    <h2 {...{\n      \"id\": \"how\"\n    }}>{`How`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\"\n      }}>{`import { downloadWithPromise } from '@shuyun-ep-team/utils/es/download';\n\nfunction download(fetch: Promise<any>, filename) {\n  return downloadWithPromise(fetch, { filename });\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"demo\"\n    }}>{`Demo`}</h3>\n\n    <Playground __position={0} __code={'<Button\\n  variant=\\\"outlined\\\"\\n  color=\\\"primary\\\"\\n  onClick={() => {\\n    const fetchPromise = window\\n      .fetch(\\'/static/js/app.js\\')\\n      .then(res => res.text())\\n    downloadWithPromise(fetchPromise, {\\n      filename: `download-${Date.now()}.js`,\\n    })\\n  }}\\n>\\n  点击下载\\n</Button>'} __scope={{\n      props: this ? this.props : props,\n      Playground,\n      Button,\n      downloadWithPromise\n    }} __codesandbox={`N4IgZglgNgpgziAXKCA7AJjAHgOgBYAuAtlEqAMYD2qBMNSIAPOhAG4AEE6AvADogAnSpQL8AfIwD0LVmJABfADQg0mXACsEyEFRp0CDSQCojvVO3YAVPBDjsAwpUwBlAIYYARpSzs8rux4wdOyuAK4ElESuBBDkrlBQAJ7sAOZ0MALRMOjsoXBoKWYWAAZUmHDu6F5YGcU47ACSYOyJlKEA5AIw7OShAhBtdniUAO7sBH4Evq4ADjPp6IotbT3uRT14MOQA1uxtU20C7OiU5EMZMIi-BAQzcIiSkikQE6EeOFREkmXwldXfTl-nm8GTM6yay1C7Gw836dHI3XcyTgBAEoRSKVgdhGLzw4xsdgqwKwSxmsH83UytkR5lscFCMHW1FSuLe9UQAEozEZJGYIEQZpQBFMAEowVzkKZgIREdidcWS9oAbj5AqFooVBAAIgB5ACy7GlkTlXQlBAAtCciMrVYLhQ5IoLUPpDTK5ThJNhXALYDbUGYxWbdXqcF0MBkABTrZhsMTrCyMPAAZjEjjVzponDVwuy7BxEx6gKJVRBAkQUmTcfMFnYjBmYgjDSmUWSztzrnQLBi1Hi7BmQju40oqRgUxe7DDmH6qBSeZgCQ5Unr8draadLskVYT0ljijMJ16RH0ODSBAAorAjzQAEKJBroCOdYQEdpc1AcpUKZRen0wHCaMgdGoWh6EQFRsymYB2AABSgVxEhSIRQgwdh5FdY12gPAAvP1-TtKZr3CCJzCNWV2gAASiWh-nic1QggAEukkQibmoXCIPYKCThGVAoEoDsAHVcWgmVqVQ9CyI9OABHIaRRl4_j0EkVRsHY_D2EDSUJJNTV2jBVBdBRY5Tiw5wCESLF2G4Tj1iiARnlQK52gABnYJMZiwdo92rGYOxYGcnIAFg89gADYPK89YwGAgAxb1oESJz-GcQ4EQdTAYKEfgliIahKDgXyEUi6topoZwICwy52AARkC7z5H0wypgAQTmKz2AjKDyBsKB0DDVCOSssQOujGR2BRCyYG4YBsLMya4HkLca2AbroD64IADINvGRJ5koZpVt6_ruBOuUwGQyUBlQdp2AAfg2NawwjQarkO9bUAa6spBkKs3zMGF1WOGAwDCKApmeoaRq-1rl2rBNNIIHAYsyFIrwIJaa1rFjiJXTHWFcGiaD4EB9igNBsn4XGayoPiBGJ_t-QJxJKbhzG9lQewyZ2aaIe4YbgCpzGmsNUdupEyIxOsnEMFGQW2ZwMBRbwR9JBRaJYkkTRJFmGZ_zgV85cxnAJjoCMujsPmJ3gY3sAIZ63zZtnuIUwThNEuAYAjRWCDF92YCWAXWcdixIFgVBvSq4pnb4jtzQAEmALUshwVBRme-Q9eKbzg5reQHeD-RPsdjG2cATodAG_FQBoOUAX3iqakbHqBLqQEaRlG0aWqQYd-swvxAaTZOjxTlPDXACC0ChgP0Bg8MBqCGi1eSY_QHUZm7VA7DQ0j3WHtQcHQP19IB-1zoMtfjJ4pehImcWiGpCNXHUVwsCuG_qUYJExCWShV6u-5GgXi-ikV5rzgINQOFhhbgJrKHOgEds41nMvMdq7QdZc3VtQSQBAsAvnWGhay38QEqn9NWLoBA-jmAfk_Y2mxUARjNvAQalsoEQOoEZDwfEPDtWdGMa8HCIwAG1zYAF0A47SQXnIhQtWFTD6FAdq0tuI4AAKoigADIfFNLQHUHh1BbAICo1REZ2GUA8B-FcwtXDtQPKENGGjxS0AvDANGj5XCvkkTWVwOAPYEGajcfoHhwie3aHgLoYAvK5AEFAMxrNPHeN8aiCAATaCPkHh2cJMDw5HmiZjWJo54n-MCY-CavoliYVsGSeCiBU7OjcSuaxtivDoESDgHWdB0D2B6g-Vw2SPEfC5tsZ67iLD1OPI05pXRcqsBgB0ta98ekWFIeQq2cB3ESLMJ9Xu_c5KAI7DvbAe9jbjyAnoUCIAj5jj0AIEGaV56LyAT_VhNkSrQFgUeK4KJpwpHcYgmAt13kJJnEQz6_0sDqUwOQOCXRDQXTPqk9AV88Cvw9vfR-z9MoSw9u_VAiRP57AeevK4tydnL3xaAl-fssU4qIb3Qq2xXBpD1tQQCugQIGDAlA_gmTGRIHYPwH4xZqgZHND-Mk3L4H8CmQIfI1B-BXH4M5HACrnLZXWPwco5B-j4tlbykAzVxp4VgNCLA3pRVAzJJQRIuY8gFCtmac0_K_ilhVdWfgUQ0Dav4CpDQcBnUWDVTAeY4YDIQHgNq5hOrsIepAAAPWqjgAATIq31NZ-CUSyDRKAdEGJUC6FG6NgUE04Gqsmv1ghNR5uqqFHAAAOHAoUS06tNJKS0kQK1VtrfWkAuD1mbMdbgXQkAUiMtQMyyepyBYgFoD6LIsq-WaJgOaJtFodb8HkAoQuQA`} mdxType=\"Playground\">\n  <Button variant=\"outlined\" color='primary' onClick={() => {\n        const fetchPromise = window.fetch('/static/js/app.js').then(res => res.text());\n        downloadWithPromise(fetchPromise, {\n          filename: `download-${Date.now()}.js`\n        });\n      }} mdxType=\"Button\">点击下载</Button>\n    </Playground>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;\n  "],"sourceRoot":""}